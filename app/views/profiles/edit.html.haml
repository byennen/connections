= content_for :header do
  #avatar.span3
    = link_to "<i class='icon-plus icon-white'></i>".html_safe, "javascript:;", class: "btn btn-success btn-mini", style: "margin-top: 40px; margin-left: 160px; position: absolute;"
    = link_to "javascript:void(0);" do
      = image_tag @profile.image.xxlarge, id: "profile-avatar", class: "circular"
  .span8
    .pro-user
      %p Hi! My name is #{@user.full_name} and I'm a #{@user.display_major} from #{@user.display_location}. Let's connect!

.row-fluid
  .container
    .span10.offset2.top2
      %a.span11.top2.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#title"}
        = image_tag 'edit.png', style: "width: 40px;"
        Key Info
        %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
      #title.slide-content.hide
        ~ form_for @user do |f|
          %p.span11
            Hi! My name is
            = f.text_field :first_name
            = f.text_field :last_name
            - if @user.alumni?
              I was a/an
            - else
              I am a/an 
            = f.text_field :major
            and 
            = f.text_field :double_major
            major at 
            = f.select :university_id, options_from_collection_for_select(University.all, :id, :name, @user.university_id)
            =". I graduated in" if @user.alumni?
            =". I will graduate in" unless @user.alumni?
            = f.select :graduation_year, options_for_select((Date.today.year + 7).downto(1940).to_a, @user.graduation_year)
            =". I am from"
            = f.select :location_id, options_from_collection_for_select(Location.all, :id, :name, @user.location_id)
            - if @user.alumni?
              =". I work in"
              = f.select :professional_field_id, options_from_collection_for_select(ProfessionalField.all, :id, :name, @user.professional_field_id)
          .span11.fright{style: "margin-right: 10px;"}
            %a.cancel.btn.btn-small.btn-danger.fright cancel
            = f.submit "Save", class: "button btn btn-small btn-success fright"

      %a.span11.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#education"}
        = image_tag 'edit.png', style: "width: 40px;"
        Education
        %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
      #education.slide-content.hide
        ~ form_tag do
          .span11= select_tag :completed, options_for_select(["Completed", "In Studying"])
          %p.span11
            I studied
            = text_field_tag :major, ""
            at
            = text_field_tag :university, ""
            = ". I graduated with a"
            = text_field_tag :degree_type
            in
            = select_tag :graduation_year, options_for_select((Date.today.year + 7).downto(1940).to_a, @user.graduation_year)
          .span11.fright
            %a.btn.btn-small.btn-success.fright{href: "javascript:;"} Add
      %a.span11.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#skill"}
        = image_tag 'edit.png', style: "width: 40px;"
        Skills
        %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
      #skill.slide-content.hide
        ~ form_for [@user, @profile] do |f|
          %p.span11
            I am skilled at
            = f.text_field :skill1
            =", "
            = f.text_field :skill2
            and
            = f.text_field :skill3
          .span11.fright
            =submit_tag "Save", class: "btn btn-small btn-success fright" 
      %a.span11.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#experience"}
        = image_tag 'edit.png', style: "width: 40px;"
        Experience
        %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
      #experience.slide-content.hide
        ~ form_for [@user, @profile] do |f|
          - @profile.experiences.build if @profile.experiences.blank?
          %p.span11
            = f.fields_for :experiences do |ef|
              I worked as a/an
              = ef.text_field :position_name
              at
              = ef.text_field :company_name
              from
              = ef.text_field :date_started
              to
              = ef.text_field :date_ended
      %a.span11.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#education"}
        = image_tag 'edit.png', style: "width: 40px;"
        Portfolio
        %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
      #portfolio.slide-content.hide
      - if current_user.alumni?
        %a.span11.slide-tab.toggle{href: "javascript:;", :"data-toggle" => ".slide-content", :"data-target" => "#contact_requirements"}
          = image_tag 'edit.png', style: "width: 40px;"
          Contact Requirements
          %i.icon-white.icon-minus{style: "float:right; margin-top: 10px; margin-right: 10px"}
        #contact_requirements.slide-content.hide
          .clearfix
          .pro-user.left
            = simple_form_for @contact_requirements, url: contact_requirements_user_profile_path do |f|
              = f.input :gpa_requirement, label: "GPA Requirements", input_html: {style: "border 1px solid red;"}
              = f.input :major_requirement, label: "Major Requirements"
              = f.input :years_working_experience, label: "Years Working Experience"
              = f.input :fields_of_interest, label: "Fields Of Interest"
              .buttons
                = f.submit "save", class: "btn btn-success btn-small"
                %a.btn.btn-small.btn-danger{style: "display: inline-block;float: none; margin-left: 10px; margin-top: 0px;"} cancel
#avatar_form{style: "opacity: 0"}
  = form_for @profile, url: upload_avatar_path, method: :post do |f|
    = f.file_field :image, id: "avatar_field"
:javascript
  $(document).ready(function(){
    $("#avatar").on("click", "a", function(){
      $("#avatar_form input").trigger("click");
    });
    $("#avatar_form").on("change", "input[type=file]",function(){
      $("a#show_waiting").click();
      $(this).closest("form").submit();
    });
    $(".slide-tab").click(function(){
      closing = $(this).find("i").hasClass("icon-minus");
      $(".slide-tab i").addClass("icon-minus");
      $(".slide-tab i").removeClass("icon-plus");

      if(closing){
        $(this).find("i").addClass("icon-plus");
        $(this).find("i").removeClass("icon-minus");
      }

    });

    $(".cancel").click(function(){
      $(this).closest(".slide-content").addClass("hide");
      $(".slide-tab").find("i").addClass("icon-minus");
      $(".slide-tab").find("i").removeClass("icon-plus");
    });
  });
